:root{--bg:#0f1115;--panel:#171923;--text:#e7eaf1;--muted:#a5acc1;--accent:#5b8cff;--danger:#ff6b6b;--ok:#2fd17d;--admin:#ffca3a;--radius:14px;--shadow:0 8px 24px rgba(0,0,0,.3)}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;height:100vh;overflow:hidden;background:linear-gradient(180deg,#0f1115,#0b0d12 60%);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .app{height:100%;display:flex;gap:10px;padding:10px}
    .col{background:var(--panel);border:1px solid #1c2030;border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    #left{width:280px;display:flex;flex-direction:column} #center{flex:1;display:flex;flex-direction:column;min-width:0} #right{width:380px;display:flex;flex-direction:column}
    header{padding:12px 14px;background:linear-gradient(180deg,#1a1f2e,#141827);border-bottom:1px solid #20263a;display:flex;align-items:center;justify-content:space-between;gap:8px}
    header h2{margin:0;font-size:15px;font-weight:800;letter-spacing:.5px;text-transform:uppercase;color:#d5dcff}
    .badge{font-size:12px;color:#c7d2fe;opacity:.8}
    .list{flex:1;overflow:auto;padding:10px}
    .small{font-size:12px;color:var(--muted)}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #2b3350;background:#18213a;color:#e5ecff;cursor:pointer}
    .btn.primary{background:#1b2d5a;border-color:#26407f} .btn.danger{background:#3a1820;border-color:#7f2632;color:#ffc9c9} .btn.ghost{background:#141a2a}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    input{font-family:inherit}
    input[type="text"],input[type="email"],input[type="password"]{padding:10px 12px;border-radius:10px;border:1px solid #2b3350;background:#0b101c;color:#fff;width:100%}
    .room{background:#1b2030;border:1px solid #232a40;border-radius:12px;padding:10px;margin:6px 0;cursor:pointer;display:flex;align-items:center;justify-content:space-between}
    .room.active{outline:2px solid var(--accent)}
    .badge-dot{display:inline-flex;align-items:center;gap:6px}
    .unread{background:#253264;border:1px solid #32448a;color:#cfe1ff;padding:2px 8px;border-radius:999px;font-size:11px}

    #messages{flex:1;overflow:auto;padding:16px;background:#0f131d}
    .msg{position:relative;margin:10px 0;padding:10px 12px;background:#161b29;border:1px solid #1f2742;border-radius:12px;max-width:80%}
    .mine{background:#102235;border-color:#173a66}
    .msg.ping{box-shadow:0 0 0 2px rgba(91,140,255,.35), 0 0 20px rgba(91,140,255,.18)}
    .msg .delBtn{position:absolute;top:6px;right:6px;opacity:0;transition:opacity .15s; cursor:pointer; border:none;background:#2a324b;color:#ffd0d0;border-radius:8px;padding:2px 6px;font-size:12px}
    .msg:hover .delBtn{opacity:1}
    .msg .replyBtn{position:absolute;top:6px;right:38px;opacity:0;transition:opacity .15s; cursor:pointer; border:none;background:#2a324b;color:#cfe1ff;border-radius:8px;padding:2px 6px;font-size:12px}
    .msg:hover .replyBtn{opacity:1}
    .msg .editBtn{position:absolute;top:6px;right:70px;opacity:0;transition:opacity .15s; cursor:pointer; border:none;background:#2a324b;color:#ffe9c0;border-radius:8px;padding:2px 6px;font-size:12px}
    .msg.mine:hover .editBtn{opacity:1}
    .edited{opacity:.7;font-size:11px;margin-left:6px}

    .topline{display:flex;gap:8px;align-items:center;margin-bottom:6px}
    .sender{font-weight:800} .sender.admin{color:var(--admin)}
    .sender .admintag{margin-left:6px;background:rgba(255,202,58,.14);border:1px solid rgba(255,202,58,.35);color:#ffd86b;font-size:10px;padding:2px 6px;border-radius:999px}
    .time{font-size:11px;color:var(--muted)} .text{white-space:pre-wrap;word-wrap:break-word}
    .mention{background:rgba(91,140,255,.16);border:1px solid rgba(91,140,255,.35);padding:0 4px;border-radius:6px}

    /* Quote (reply) */
    .quote{border-left:3px solid #3a5bd9;background:rgba(58,91,217,.08);padding:6px 8px;border-radius:8px;margin-bottom:6px}
    .quote .q-author{font-size:12px;color:#b8c6ff;margin-bottom:2px}
    .quote .q-text{font-size:12px;color:#cfd7ff;opacity:.92}
    .jump{cursor:pointer;text-decoration:underline;opacity:.9}
    .flash{animation:flash 1.4s ease-out}
    @keyframes flash{0%{box-shadow:0 0 0 0 rgba(91,140,255,.6)}60%{box-shadow:0 0 0 8px rgba(91,140,255,.0)}100%{box-shadow:none}}

    /* Embeds */
    .yt-card{position:relative;width:min(560px,100%);aspect-ratio:16/9;border-radius:12px;overflow:hidden;border:1px solid #223055;background:#0c1222;margin-top:6px}
    .yt-card iframe{position:absolute;inset:0;width:100%;height:100%;border:0}
    .gif-card{display:block;width:min(300px,55%);border-radius:12px;overflow:hidden;border:1px solid #223055;background:#0c1222;margin-top:6px}
    .gif-card img{display:block;width:100%;height:auto;max-height:320px;object-fit:contain}

    #composer{display:flex;gap:8px;padding:12px;border-top:1px solid #242a3f;background:#151a27;align-items:center;position:relative}
    #msgInput{flex:1;padding:12px 14px;border-radius:12px;border:1px solid #2b3350;background:#0b101c;color:#e7eaf1}
    .iconbtn{padding:8px;border:1px solid #2b3350;border-radius:10px;background:#18213a;cursor:pointer;color:#e7eaf1;font-weight:700}
    .iconbtn:hover{filter:brightness(1.05)}
    .replyPreview{position:absolute;left:12px;right:12px;top:-52px;background:#161b29;border:1px solid #2b3350;border-bottom:none;border-radius:12px 12px 0 0;padding:6px 10px;font-size:12px;color:#cfe1ff;display:none}
    .replyPreview .close{float:right;cursor:pointer;color:#ffb0b0}

    /* Users list */
    .user{background:#1b2030;border:1px solid #232a40;border-radius:12px;padding:10px;margin:6px 0;display:flex;align-items:center;gap:10px}
    .u-meta{flex:1} .u-name{font-weight:700}
    .u-sub{font-size:12px;color:#a5acc1;margin-top:2px;height:16px}
    .status{display:inline-flex;align-items:center;gap:6px}
    .dot{width:10px;height:10px;border-radius:50%;background:#7c86a5;display:inline-block}
    .dot.on{background:var(--ok);box-shadow:0 0 0 2px rgba(47,209,125,.18)}
    .kebab{padding:6px 10px;border-radius:10px;border:1px solid #2b3350;background:#18213a;color:#e5ecff;cursor:pointer}

    .ctx{position:fixed;z-index:2147483647;display:none;min-width:240px;background:#0f1320;border:1px solid #293255;border-radius:12px;box-shadow:var(--shadow)}
    .ctx .item{padding:10px 12px;cursor:pointer;border-bottom:1px solid #22283e}
    .ctx .item:last-child{border-bottom:none} .ctx .item:hover{background:#1a2240}
    .ctx .danger{color:var(--danger);font-weight:700}

    .authwrap{height:100vh;display:grid;place-items:center}
    .authcard{width:min(880px,94vw);background:#171923;border:1px solid #20263a;border-radius:16px;box-shadow:var(--shadow);padding:18px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px} .vstack{display:flex;flex-direction:column;gap:8px}
    .divider{height:1px;background:#222a44;margin:8px 0} .title{font-weight:800;font-size:18px} .err{color:#ffb0b0;font-size:12px}

    #diag{padding:10px;background:#101420;font-size:12px;color:#90a3d3;border-top:1px solid #1d2237} code.kv{display:block;color:#ccd8ff}
    #roomActions{display:none;gap:8px;padding:8px;border-top:1px solid #232a3a}

    /* Popovers (emoji/gif/reactions)
       FIX: position:fixed για να μην «κόβονται» από τα panels */
    .pop{
      position:fixed;
      z-index:3000;
      background:#0f1320;
      border:1px solid #293255;
      border-radius:12px;
      box-shadow:var(--shadow);
      padding:8px;
      display:none;
      max-height:320px;
      overflow:auto
    }
    .emoji-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:6px}
    .emoji{font-size:20px;padding:6px;cursor:pointer;border-radius:8px;text-align:center}
    .emoji:hover{background:#202744}

    /* GIF panel: responsive width ώστε να χωράει στην οθόνη */
    .gif-panel{width:min(420px, calc(100vw - 24px))}
    .gif-head{display:flex;gap:6px;margin-bottom:6px}
    .gif-head input{flex:1}
    .gif-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;max-height:260px;overflow:auto}
    .gif-item{position:relative;border-radius:10px;overflow:hidden;border:1px solid #223055;background:#0c1222;cursor:pointer}
    .gif-item img{width:100%;height:100%;object-fit:cover;display:block}
    .gif-empty{padding:18px;text-align:center;color:#93a1d8}

    #typingBanner{display:none;padding:6px 12px;color:#c9d3ff;font-size:12px;border-bottom:1px solid #20263a;background:#141a27}

    /* Reactions chips */
    .reactions{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .rx-chip{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;border-radius:999px;border:1px solid #2b3350;background:#10182e;font-size:12px;cursor:pointer;user-select:none}
    .rx-chip.mine{background:#1b2d5a;border-color:#2c478f}
    .rx-btn{padding:4px 8px;border-radius:8px;border:1px solid #2b3350;background:#18213a;color:#e7eaf1;cursor:pointer;font-size:12px}
  /* Avatars */
.u-ava{width:32px;height:32px;border-radius:50%;object-fit:cover;border:2px solid #223055}
.u-ava.admin{box-shadow:0 0 0 2px rgba(255,202,58,.45)}
.msgRow{display:flex;gap:10px;align-items:flex-start;margin:10px 0}
.msgRow.mine{flex-direction:row-reverse}
.msgRow .ava{width:36px;height:36px;border-radius:50%;object-fit:cover;border:2px solid #223055}
.msgRow .ava.admin{box-shadow:0 0 0 2px rgba(255,202,58,.45)}
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  z-index: 3000;

  display: flex;
  align-items: center;
  justify-content: center;
#profileBox { display:flex; align-items:center; gap:12px; }
#avatarPreview { border-radius:50%; border:2px solid #444; }
#avatarRandomBtn { padding:8px 12px; border-radius:10px; border:0; cursor:pointer; }
